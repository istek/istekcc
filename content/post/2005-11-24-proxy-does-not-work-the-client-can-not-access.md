---
title: Proxy不工作，客户端无法上网！
date: 2005-11-24T11:04:47+00:00
layout: post
categories:
  - 随笔
---
昨天一个同事打电话过来说，他们办公室的电脑无法上网，具体的情况是代理服务器可以上网，但是客户机无法上网，我让他检查了IP地址，网关，防火墙，都是正常的。

他们办公室的局域网网络是我弄的，details如下：

小区ADSL接入，3台办公电脑，由于IP地址范围已经被指定为192.168.0.0/24中的任一IP地址，无法采用winxp自带的ICS服务。

代理服务器软件采用Sygate Office，将其中一台台式机作为代理服务器，安装Sygate软件，采用双网卡的形式。

代理服务器的配置如下：

ADSL:
```
IP: 192.168.0.24
netmask: 255.255.255.0
DNS: 202.100.64.68
DNS: 202.100.64.66
```
Lan:
```
IP: 10.1.1.1
netmask:255.255.255.0
```

ADSL是连接小区ADSL线路的网卡，Lan是连接内网的网卡。

另两台PC的配置如下:

PC1:
```
IP:10.1.1.10
netmask:255.255.255.0
Gateway:10.1.1.1
```

PC2:
```
IP:10.1.1.12
netmask:255.255.255.0
Gateway:10.1.1.1
```

关于Sygate的配置，我这里简要的说一下：第一，因为是双网卡的模式，不要选择Single Card mode，；第二，DNS转发要打开，设置转发的DNS地址；第三，你可以自己打开Sygate内自带的DHCP服务；第四，注意选择正确的内网网卡，在我们这个具体实例中，是Lan；第五，设置自动拨号，这里Sygate服务只要一启动，就可以上网了；第六，注意防火墙的问题，有条件的话，最好安装Sygate自带的防火墙。

针对他出现的问题，我们检查网络是否连通，配置是否有变更，防火墙是否配置有误。

后来发现，代理服务器内网网卡无网络状态，即不收包，不发包，ipconfig/all后，无任何TCP/IP信息，由此可以判断是TCP/IP的问题，打开网络连接，内网网卡的属性，查看是否有TCP/IP服务，是否被选中，若已经被选择，则先取消，再选择，然后ping内网，可以看到有回应包，说明问题已经解决。

好了，我同事的问题就这样解决了。留个东西，以后可能有用的着的地方。